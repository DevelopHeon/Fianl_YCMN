<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="employeeMapper">

	<select id="loginEmployee" parameterType="Employee" resultType="Employee">
		SELECT A.*,
		       B.DEP_NAME,
		       C.POS_NAME
		FROM EMPLOYEE A
		LEFT OUTER JOIN DEPARTMENT B
		    ON A.DEP_NO = B.DEP_NO
		LEFT OUTER JOIN JOB_POSITION C
		    ON A.POS_NO = C.POS_NO
		WHERE A.EMP_ID = #{empId}
		AND A.STATUS = 'Y'
	</select>
	
	<insert id="insertEmployee" parameterType="Employee">
		INSERT ALL 
		INTO EMPLOYEE(EMP_NO, EMP_NAME, EMP_ID, EMP_PWD, EMP_EMAIL, EMP_PHONE, CATEGORY, STATUS)
   		VALUES(SEQ_EMP.NEXTVAL, #{empName}, #{empId}, #{empPwd}, #{empEmail}, #{empPhone}, DEFAULT, DEFAULT)
   		INTO PERSONNEL_CHART(EMP_NO, HIRE_DATE)
		VALUES(SEQ_EMP.CURRVAL, SYSDATE)
        SELECT * FROM DUAL
	</insert>
	
	<select id="idCheck" parameterType="string" resultType="_int">
		SELECT COUNT(EMP_ID)
		FROM EMPLOYEE
		WHERE EMP_ID = #{empId}
	</select>
	
	<update id="updateEmp" parameterType="Employee">
		UPDATE EMPLOYEE SET EMP_EMAIL = #{empEmail},
								OFFICE_TEL = #{officeTel}, 
								EMP_PHONE = #{empPhone}, 
								EMP_LOC = #{empLoc} 
								WHERE EMP_ID = #{empId}
	</update>
	
	
	
	<insert id="insertStart" parameterType="WorkingDay">
		INSERT INTO WORKINGDAY
		(WORK_NO, EMP_NO, TODAY, START_TIME, STATUS)
		VALUES(SEQ_WORK.NEXTVAL, #{empNo}, SYSDATE, #{startTime}, 'Y')
	</insert>
	
	<select id="selectEmpAddress" parameterType="Employee" resultType="Employee" >
		SELECT A.EMP_NAME, A.EMP_ID, B.POS_NAME, C.DEP_NAME
		FROM EMPLOYEE A
		LEFT JOIN JOB_POSITION B ON A.POS_NO = B.POS_NO
		LEFT JOIN DEPARTMENT C ON A.DEP_NO = C.DEP_NO
		<![CDATA[WHERE A.STATUS = 'Y' AND A.EMP_ID != 'admin']]>
	</select>
	
</mapper>
