<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="approvalMapper">
	<insert id="insertApproval" parameterType="Approval">
		INSERT INTO APPROVAL
		(APP_NO, APP_WRITER_NO, APP_TITLE, APP_CREATE_DATE, APP_KINDS, APP_STATUS, STATUS)
		VALUES(SEQ_APP.NEXTVAL, #{appWriterNo}, #{appTitle}, #{appCreateDate}, #{appKinds}, DEFAULT, DEFAULT)
	</insert>
	<insert id="insertApperAccount" parameterType="com.uni.spring.approval.model.dto.ApperAccount">
		INSERT INTO APPER_ACCOUNT
		VALUES(SEQ_APP.CURRVAL, #{erAccountHolder}, #{bankName}, #{accountNumber}, #{erAmount})
	</insert>
	<insert id="insertApprovalErs" parameterType="java.util.List">
		<foreach collection="list" item="item" index="index" open="INSERT ALL" close="SELECT * FROM DUAL" separator=" ">
		INTO APP_ER(APP_NO, ER_CLASS, ER_DATE, ER_DETAIL, ER_USE, ER_PAYMENT, CATEGORY)
		VALUES
		(SEQ_APP.CURRVAL, #{item.erClass}, #{item.erDate}, #{item.erDetail}, #{item.erUse}, #{item.erPayment}, DEFAULT)
	</foreach>
	</insert>
	<insert id="insertAttachment" parameterType="Attachment">
		INSERT INTO ATTACHMENT
		VALUES(SEQ_ANO.NEXTVAL, #{empNo}, SEQ_APP.CURRVAL, 2, #{originName}, #{changeName}, #{filePath}, DEFAULT, DEFAULT)
	</insert>
	
	<select id="selectApproverList" resultType="Employee">
		SELECT A.EMP_NO, A.EMP_NAME, A.POS_NO, B.POS_NAME, C.DEP_NAME
		FROM EMPLOYEE A
		LEFT JOIN JOB_POSITION B ON A.POS_NO = B.POS_NO
		LEFT JOIN DEPARTMENT C ON A.DEP_NO = C.DEP_NO
		ORDER BY A.POS_NO
	</select>
</mapper>
